# Fixminer for Casino
Modified Fixminer for experiment of Casino. It generated all patch candidates and meta-information, and not run tests.

## Requirement
Fixminer need JDK 1.8 and Maven to build.\
Defects4j should be v1.2.0.\
Note: Casino and other tools need JDK 1.7, not 1.8. \
Note 2: We found latest version of OpenJDK 1.7 is not work properly for Defects4j. Use official JDK 1.7 from Oracle homepage instead.

## Build

```
mvn install -DskipTests
```

## Run

Usage:
```
java -Xmx<memory-to-use> -cp ./lib/JavaCodeParser-1.0.jar:./target/FixMiner-0.0.1-SNAPSHOT-jar-with-dependencies.jar edu.lu.uni.serval.fixminer.main.Main [option] <test_info_dir> <FL_result_dir> <project_dir> <d4j_dir> <version>
```

#### Important: last character of every paths in arguments should be slash(/).
* ```<test_info_dir>```: Direcotry of test information of each version. Usually it may be ```./FailedTestCases/```.
* ```<FL_result_dir>```: Directory of fault localization result. Usually it may be ```./BugPositions/```.
* ```<project_dir>```: Location of projects. If your project is in ```./buggy/Chart_1/```, then it should be ```./buggy/```.
* ```<d4j_dir>```: Location of Defects4j. If Defects4j is installed in ```/defects4j```, then it should be ```/defects4j/```.
* ```<version>```: Version name to run. Format should be ```<project>_<version>```. (e.g. ```Chart_24```)
  
### Options
* ```--max-loc <loc_number>``` or ```-l <loc_number>```: Use only top-```<loc_number>``` ranked locations in FL result.
* ```--sub-template```: Unlike other tools, original Fixminer generates patch candidates with 'sub-templates' after every 'primary-templates' are tried. Note that we do not use sub-templates for Casino.\
Note: this option will generate a lot of patch candidates (usually 1M+). Check your remaining space in disk and give enough memory!

## Output
Output files are in ```./d4j/<version>```.
* ```0/```: Patch candidates generated by primary-templates
* ```1/```: Patch candidates generated by sub-templates, if ```--sub-template``` option given.

In each directory:
* ```switch-info.json```: Meta-information of patch candidates
* ```<FL_rank>/<template>/<id>/<patched_file>```: patched files. 

# Fix Templates
The fix templates are located in: ```src/main/java/edu/uni/lu/serval/fixminer/fixtemplate```
